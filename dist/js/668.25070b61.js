"use strict";(self["webpackChunkinfinity_flowers"]=self["webpackChunkinfinity_flowers"]||[]).push([[668],{5830:function(t,e){e["Z"]={inject:["emitter"],methods:{getCarts(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/flower-api/cart";this.$http.get(t).then((t=>{t.data.success&&(this.cartqty=0,this.isLoading=!1,this.CartList=t.data.data,this.cartLength=t.data.data.carts.length,t.data.data.carts.forEach((t=>{this.cartqty+=t.qty})),this.emitter.emit("push-notice",{data:this.cartLength,category:"cart"}))}))}}}},1557:function(t,e,a){a.d(e,{Z:function(){return w}});var s=a(6252),r=a(3577);const i={class:"mt-2"},n={class:"nav justify-content-center"},l={class:"nav-item"},c={class:"nav-link ordernav text-dark"},o=(0,s._)("span",null,"購物車",-1),d={class:"nav-item"},u={class:"nav-link ordernav text-dark"},p=(0,s._)("span",null,"建立訂單",-1),h={class:"nav-item"},m={class:"nav-link ordernav text-dark"},g=(0,s._)("span",null,"訂單確認",-1),_={class:"nav-item"},v={class:"nav-link ordernav text-dark"},b=(0,s._)("span",null,"訂單完成",-1);function y(t,e,a,y,C,f){return(0,s.wg)(),(0,s.iD)("div",i,[(0,s._)("ul",n,[(0,s._)("li",l,[(0,s._)("p",c,[(0,s._)("i",{class:(0,r.C_)(["bi bi-flower3","cart"===a.PageName?"ordernav-icon":"text-secondary"])},null,2),o])]),(0,s._)("li",d,[(0,s._)("p",u,[(0,s._)("i",{class:(0,r.C_)(["bi bi-flower3","order"===a.PageName?"ordernav-icon":"text-secondary"])},null,2),p])]),(0,s._)("li",h,[(0,s._)("p",m,[(0,s._)("i",{class:(0,r.C_)(["bi bi-flower3","orderchecked"===a.PageName?"ordernav-icon":"text-secondary"])},null,2),g])]),(0,s._)("li",_,[(0,s._)("p",v,[(0,s._)("i",{class:(0,r.C_)(["bi bi-flower3","orderCompleted"===a.PageName?"ordernav-icon":"text-secondary"])},null,2),b])])])])}var C={data(){return{isPage:""}},props:["PageName"]},f=a(3744);const k=(0,f.Z)(C,[["render",y]]);var w=k},9668:function(t,e,a){a.r(e),a.d(e,{default:function(){return M}});a(7658);var s=a(6252),r=a(9963),i=a(3577);const n={class:"container"},l=(0,s._)("h3",{class:"orderNavDetail"},[(0,s._)("i",{class:"bi bi-flower3 text-success"}),(0,s._)("span",null,"購物車")],-1),c={key:0},o=(0,s._)("i",{class:"bi bi-trash3"},null,-1),d={class:"row"},u={class:"card col-md-7 cart-card"},p={class:"blockquote mb-0 row"},h=["onClick"],m=(0,s._)("i",{class:"bi bi-x-lg"},null,-1),g=[m],_=["src","alt"],v={class:"col-7 align-items-center p-0"},b={class:""},y={class:"input-group"},C=["onClick","disabled"],f=["onUpdate:modelValue","onChange"],k=["onClick"],w={class:"cart-info col-md-5 col-12"},x={class:"ps-md-5 mt-4"},q=(0,s._)("hr",null,null,-1),N={key:1,class:"position-absolute bottom-50 start-50 translate-middle text-center"},L=(0,s._)("h2",null,"購物車沒有東西",-1);function $(t,e,a,m,$,P){const D=(0,s.up)("LoadingOverlay"),O=(0,s.up)("OrderNav");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(D,{active:$.isLoading},null,8,["active"]),(0,s._)("div",n,[(0,s.Wm)(O,{PageName:$.pageName,class:"orderNav"},null,8,["PageName"]),l,(0,s._)("div",null,[0!==$.cartLength?((0,s.wg)(),(0,s.iD)("div",c,[(0,s._)("button",{onClick:e[0]||(e[0]=(...t)=>P.deleteAllCart&&P.deleteAllCart(...t)),class:"mb-1 btn btn-outline-danger"},[o,(0,s.Uk)("全部刪除 ")]),(0,s._)("div",d,[(0,s._)("div",u,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)($.CartList.carts,((t,e)=>((0,s.wg)(),(0,s.iD)("div",{class:"card-body",key:e},[(0,s._)("blockquote",p,[(0,s._)("button",{type:"button",onClick:(0,r.iM)((e=>P.deleteCart(t.id)),["prevent"]),class:"col-1 btn btn-light border-0 text-danger"},g,8,h),(0,s._)("img",{src:t.product.imageUrl,alt:t.product.title,class:"col-4"},null,8,_),(0,s._)("div",v,[(0,s._)("div",b,[(0,s._)("p",null,(0,i.zw)(t.product.title),1),(0,s._)("p",null,"NT$"+(0,i.zw)(t.product.price),1),(0,s._)("div",y,[(0,s._)("button",{class:"btn btn-outline-secondary",type:"button",onClick:(0,r.iM)((e=>P.refreshCart(t,t.qty-1)),["prevent"]),disabled:1===t.qty},"-",8,C),(0,s.wy)((0,s._)("input",{type:"number",class:"form-control qty-input",placeholder:"請輸入數量","aria-label":"qty","onUpdate:modelValue":e=>t.qty=e,onChange:(0,r.iM)((e=>P.refreshCart(t,t.qty)),["prevent"])},null,40,f),[[r.nr,t.qty]]),(0,s._)("button",{class:"btn btn-outline-secondary",type:"button",onClick:(0,r.iM)((e=>P.refreshCart(t,t.qty+1)),["prevent"])},"+",8,k)])])])])])))),128))]),(0,s._)("div",w,[(0,s._)("div",x,[(0,s._)("h4",null,"品項 "+(0,i.zw)($.cartLength)+" 個",1),(0,s._)("h4",null,"數量 "+(0,i.zw)($.cartqty)+" 個",1),q,(0,s._)("h3",null,"總價 NT$"+(0,i.zw)($.CartList.total),1),(0,s._)("button",{type:"submit",class:"btn w-100 mt-2 cart-confirm",onClick:e[1]||(e[1]=(...t)=>P.toOrder&&P.toOrder(...t))},"確認購買")])])])])):((0,s.wg)(),(0,s.iD)("div",N,[L,(0,s._)("button",{type:"button",class:"btn btn-danger mt-2",onClick:e[2]||(e[2]=(0,r.iM)((e=>t.$router.push("/products")),["prevent"]))},"馬上逛逛")]))])])],64)}var P=a(1557),D=a(5830),O={data(){return{pageName:"cart",isLoading:!1,CartList:[],cartqty:0,cartLength:0}},components:{OrderNav:P.Z},inject:["emitter"],methods:{toOrder(){this.$router.push("/order")},refreshCart(t,e){const a=`https://vue3-course-api.hexschool.io/api/flower-api/cart/${t.id}`,s={product_id:t.product_id,qty:e};this.$http.put(a,{data:s}).then((t=>{t.data.success&&this.getCarts()})).catch((t=>{this.emitter.emit("push-message",{style:"danger",title:t.response.data})}))},deleteCart(t){const e=`https://vue3-course-api.hexschool.io/api/flower-api/cart/${t}`;this.$http.delete(e).then((t=>{t.data.success&&(this.getCarts(),this.emitter.emit("push-message",{style:"danger",title:t.data.message}))})).catch((t=>{this.emitter.emit("push-message",{style:"danger",title:t.response.data})}))},deleteAllCart(){const t="https://vue3-course-api.hexschool.io/api/flower-api/carts";this.$http.delete(t).then((t=>{t.data.success&&(this.getCarts(),this.emitter.emit("push-message",{style:"danger",title:t.data.message}))})).catch((t=>{this.emitter.emit("push-message",{style:"danger",title:t.response.data})}))}},mixins:[D.Z],created(){this.getCarts()},mounted(){this.emitter.emit("page-change",{data:"cart"})}},Z=a(3744);const z=(0,Z.Z)(O,[["render",$]]);var M=z}}]);
//# sourceMappingURL=668.25070b61.js.map