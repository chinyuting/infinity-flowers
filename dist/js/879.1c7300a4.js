"use strict";(self["webpackChunkinfinity_flowers"]=self["webpackChunkinfinity_flowers"]||[]).push([[879],{5830:function(t,i){i["Z"]={inject:["emitter"],methods:{getCarts(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/flower-api/cart";this.$http.get(t).then((t=>{t.data.success&&(this.cartqty=0,this.isLoading=!1,this.CartList=t.data.data,this.cartLength=t.data.data.carts.length,t.data.data.carts.forEach((t=>{this.cartqty+=t.qty})),this.emitter.emit("push-Cartnotice",{data:this.cartLength,category:"cart"}))}))}}}},2497:function(t,i){i["Z"]={methods:{getFavorite(){if(localStorage.getItem("favoriteItem")){const t=localStorage.getItem("favoriteItem");this.idList=JSON.parse(t),this.favoriteLength=this.idList.length}else this.idList=[],this.cartLength=0,console.log(this.favoriteLength);this.emitter.emit("push-Favnotice",{data:this.favoriteLength,category:"cart"})}}}},685:function(t,i,e){e(7658);i["Z"]={inject:["emitter"],methods:{goForDetail(t){if(localStorage.getItem("viewedItem")){const t=localStorage.getItem("viewedItem");this.viewedList=JSON.parse(t)}else this.viewedList=[];this.viewedList.every((i=>i!==t.id))&&(this.viewedList.push(t.id),localStorage.setItem("viewedItem",JSON.stringify(this.viewedList))),this.emitter.emit("push-ProductDetail",{data:t,qty:1}),this.$router.push(`/products/${t.id}`)}}}},7879:function(t,i,e){e.r(i),e.d(i,{default:function(){return P}});e(7658);var s=e(6252),a=e(9963),o=e(3577);const r={class:"container"},c={key:0,class:"position-relative text-center my-5 py-5"},d=(0,s._)("h2",{class:"text-nowrap"},"尚未收藏任何產品",-1),n={key:1},l={class:"row"},h={class:"card mt-1 mb-2 mx-auto product-card"},g=["onClick"],p={class:"overflow-hidden text-light position-relative product-card-pic"},u={class:"position-absolute bg-secondary px-2 bottom-0 end-0 rounded m-2"},v={class:"card-text"},m=["src","alt"],f={class:"card-body text-dark"},L={class:"row overflow-hidden"},w=["title"],y={class:"mw-25 text-end col-2 add-favorite"},_=["onClick"],k={key:0,class:"bi bi-heart text-danger"},b={key:1,class:"bi bi-heart-fill text-danger"},x={class:"card-text"},C={key:0,class:"text-decoration-line-through fs-6"},F={class:"fs-5"},I={class:"card-footer"},D=["onClick"];function S(t,i,e,S,O,$){const Z=(0,s.up)("LoadingOverlay");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(Z,{active:O.isLoading},null,8,["active"]),(0,s._)("div",r,[0===O.favoriteList.length?((0,s.wg)(),(0,s.iD)("div",c,[d,(0,s._)("button",{type:"button",class:"btn button-light-color mt-2",onClick:i[0]||(i[0]=(0,a.iM)((i=>t.$router.push("/products")),["prevent"]))},"馬上逛逛")])):((0,s.wg)(),(0,s.iD)("div",n,[(0,s._)("div",l,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(O.favoriteList,(i=>((0,s.wg)(),(0,s.iD)("div",{class:"col-sm-12 col-md-6 col-lg-4",key:i.id},[(0,s._)("div",h,[(0,s._)("a",{class:"product-card-content",href:"#",onClick:(0,a.iM)((e=>t.goForDetail(i)),["prevent"])},[(0,s._)("div",p,[(0,s._)("div",u,[(0,s._)("p",v,(0,o.zw)(i.category),1)]),(0,s._)("img",{src:i.imageUrl,alt:i.title,class:"card-img-top d-block mx-auto align-middle"},null,8,m)]),(0,s._)("div",f,[(0,s._)("h5",L,[(0,s._)("div",{class:"card-title col-10 overflow-hidden product-card-title",title:i.title},(0,o.zw)(i.title),9,w),(0,s._)("div",y,[(0,s._)("a",{href:"#",onClick:(0,a.iM)((t=>$.removeFavorite(i)),["stop","prevent"])},[O.idList.every((t=>i.id!==t))?((0,s.wg)(),(0,s.iD)("i",k)):((0,s.wg)(),(0,s.iD)("i",b)),(0,s.Uk)((0,o.zw)(null))],8,_)])]),(0,s._)("p",x,[i.origin_price!==i.price?((0,s.wg)(),(0,s.iD)("span",C," NT$"+(0,o.zw)(i.origin_price),1)):(0,s.kq)("",!0),(0,s._)("span",F," NT$"+(0,o.zw)(i.price),1)])])],8,g),(0,s._)("div",I,[(0,s._)("button",{class:"btn button-light-color w-100",type:"button",onClick:(0,a.iM)((t=>$.addCart(i)),["prevent"])},"加入購物車",8,D)])])])))),128))])]))])],64)}var O=e(5830),$=e(2497),Z=e(685),q={data(){return{favoriteList:[],pagination:{},page:1,productCategory:[],idList:[],isLoading:!1}},inject:["emitter"],methods:{getFavoriteProducts(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/flower-api/products/all";this.$http.get(t).then((t=>{if(t.data.success){this.isLoading=!1;const i=t.data.products;this.pagination=t.data.pagination;const e=[];this.favoriteList=[],i.forEach((t=>{e.push(t.category),this.idList.some((i=>t.id===i))&&this.favoriteList.push(t)})),this.productCategory=e.filter(((t,i,e)=>e.indexOf(t)===i))}})).catch((t=>{this.isLoading=!1,this.emitter.emit("push-message",{style:"danger",title:t.response.data})}))},addCart(t){this.isLoading=!0;const i="https://vue3-course-api.hexschool.io/api/flower-api/cart",e={product_id:t.id,qty:1};this.$http.post(i,{data:e}).then((t=>{t.data.success&&(this.isLoading=!1,this.getFavoriteProducts(),this.getCarts(),this.emitter.emit("push-message",{style:"success",title:t.data.message}))})).catch((t=>{this.isLoading=!1,this.emitter.emit("push-message",{style:"danger",title:t.response.data})}))},removeFavorite(t){this.idList.indexOf(t.id),this.idList.splice(this.idList.indexOf(t.id),1),localStorage.setItem("favoriteItem",JSON.stringify(this.idList)),this.getFavoriteProducts(),this.getFavorite(),this.emitter.emit("push-message",{style:"danger",title:"已取消收藏"})}},mixins:[O.Z,$.Z,Z.Z],created(){this.getFavoriteProducts(),this.getFavorite()},mounted(){this.emitter.emit("page-change",{data:"favorite"})}},N=e(3744);const z=(0,N.Z)(q,[["render",S]]);var P=z}}]);
//# sourceMappingURL=879.1c7300a4.js.map