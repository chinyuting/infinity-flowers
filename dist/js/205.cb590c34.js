"use strict";(self["webpackChunkinfinity_flowers"]=self["webpackChunkinfinity_flowers"]||[]).push([[205],{5830:function(t,e){e["Z"]={inject:["emitter"],methods:{getCarts(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/flower-api/cart";this.$http.get(t).then((t=>{t.data.success&&(this.cartqty=0,this.isLoading=!1,this.CartList=t.data.data,this.cartLength=t.data.data.carts.length,t.data.data.carts.forEach((t=>{this.cartqty+=t.qty})),this.emitter.emit("push-Cartnotice",{data:this.cartLength,category:"cart"}))}))}}}},9939:function(t,e,a){a.d(e,{Z:function(){return k}});var s=a(6252),r=a(3577);const i={class:"mt-2"},l={class:"nav justify-content-center"},n={class:"nav-item"},c={class:"nav-link orderNav text-dark"},o=(0,s._)("span",null,"購物車",-1),d={class:"nav-item"},u={class:"nav-link orderNav text-dark"},p=(0,s._)("span",null,"建立訂單",-1),h={class:"nav-item"},m={class:"nav-link orderNav text-dark"},g=(0,s._)("span",null,"訂單確認",-1),_={class:"nav-item"},v={class:"nav-link orderNav text-dark"},b=(0,s._)("span",null,"訂單完成",-1);function y(t,e,a,y,C,f){return(0,s.wg)(),(0,s.iD)("div",i,[(0,s._)("ul",l,[(0,s._)("li",n,[(0,s._)("p",c,[(0,s._)("i",{class:(0,r.C_)(["bi bi-flower3","cart"===a.PageName?"orderNav-icon":"text-secondary"])},null,2),o])]),(0,s._)("li",d,[(0,s._)("p",u,[(0,s._)("i",{class:(0,r.C_)(["bi bi-flower3","order"===a.PageName?"orderNav-icon":"text-secondary"])},null,2),p])]),(0,s._)("li",h,[(0,s._)("p",m,[(0,s._)("i",{class:(0,r.C_)(["bi bi-flower3","orderChecked"===a.PageName?"orderNav-icon":"text-secondary"])},null,2),g])]),(0,s._)("li",_,[(0,s._)("p",v,[(0,s._)("i",{class:(0,r.C_)(["bi bi-flower3","orderCompleted"===a.PageName?"orderNav-icon":"text-secondary"])},null,2),b])])])])}var C={data(){return{isPage:""}},props:["PageName"]},f=a(3744);const w=(0,f.Z)(C,[["render",y]]);var k=w},7205:function(t,e,a){a.r(e),a.d(e,{default:function(){return j}});a(7658);var s=a(6252),r=a(9963),i=a(3577);const l={class:"container"},n=(0,s._)("h3",{class:"orderNavDetail"},[(0,s._)("i",{class:"bi bi-flower3 text-light-color"}),(0,s._)("span",{class:"text-deep-color"},"購物車")],-1),c={key:0},o=(0,s._)("i",{class:"bi bi-trash3"},null,-1),d={class:"row"},u={class:"card col-md-8 col-lg-7 cart-card mb-md-5"},p={class:"mb-0 row"},h=["onClick"],m=(0,s._)("i",{class:"bi bi-x-lg"},null,-1),g=[m],_=["src","alt"],v={class:"col-7 align-items-center p-0"},b={class:"w-100 fs-5"},y={class:"cartItem-name"},C={class:"input-group"},f=["onClick","disabled"],w=["onUpdate:modelValue","onChange"],k=["onClick"],N={class:"cart-info col-md-4 col-lg-5 col-12 mb-sm-5"},x={class:"ps-md-5 mt-4"},q=(0,s._)("hr",null,null,-1),L={key:1,class:"position-relative text-center my-5 py-5"},$=(0,s._)("h2",null,"購物車沒有東西",-1);function P(t,e,a,m,P,D){const O=(0,s.up)("LoadingOverlay"),Z=(0,s.up)("OrderNav");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(O,{active:P.isLoading},null,8,["active"]),(0,s._)("div",l,[(0,s.Wm)(Z,{PageName:P.pageName,class:"orderNav"},null,8,["PageName"]),n,(0,s._)("div",null,[0!==P.cartLength?((0,s.wg)(),(0,s.iD)("div",c,[(0,s._)("button",{onClick:e[0]||(e[0]=(...t)=>D.deleteAllCart&&D.deleteAllCart(...t)),class:"mb-1 btn btn-outline-danger"},[o,(0,s.Uk)("全部刪除 ")]),(0,s._)("div",d,[(0,s._)("div",u,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(P.CartList.carts,((t,e)=>((0,s.wg)(),(0,s.iD)("div",{class:"card-body justify-content-around d-flex align-items-center",key:e},[(0,s._)("div",p,[(0,s._)("button",{type:"button",onClick:(0,r.iM)((e=>D.deleteCart(t.id)),["prevent"]),class:"col-1 btn btn-light border-0 text-danger text-center p-0"},g,8,h),(0,s._)("img",{src:t.product.imageUrl,alt:t.product.title,class:"col-4 flex-grow-1"},null,8,_),(0,s._)("div",v,[(0,s._)("div",b,[(0,s._)("p",y,(0,i.zw)(t.product.title),1),(0,s._)("p",null,"NT$"+(0,i.zw)(t.product.price),1),(0,s._)("div",C,[(0,s._)("button",{class:"btn btn-outline-secondary",type:"button",onClick:(0,r.iM)((e=>D.refreshCart(t,t.qty-1)),["prevent"]),disabled:1===t.qty},"-",8,f),(0,s.wy)((0,s._)("input",{type:"number",class:"form-control qty-input",placeholder:"請輸入數量","aria-label":"qty","onUpdate:modelValue":e=>t.qty=e,onChange:(0,r.iM)((e=>D.refreshCart(t,t.qty)),["prevent"])},null,40,w),[[r.nr,t.qty]]),(0,s._)("button",{class:"btn btn-outline-secondary",type:"button",onClick:(0,r.iM)((e=>D.refreshCart(t,t.qty+1)),["prevent"])},"+",8,k)])])])])])))),128))]),(0,s._)("div",N,[(0,s._)("div",x,[(0,s._)("h4",null,"品項 "+(0,i.zw)(P.cartLength)+" 個",1),(0,s._)("h4",null,"數量 "+(0,i.zw)(P.cartqty)+" 個",1),q,(0,s._)("h3",null,"總價 NT$"+(0,i.zw)(P.CartList.total),1),(0,s._)("button",{type:"submit",class:"btn w-100 mt-2 button-light-color btn-lg",onClick:e[1]||(e[1]=(...t)=>D.toOrder&&D.toOrder(...t))},"確認購買")])])])])):((0,s.wg)(),(0,s.iD)("div",L,[$,(0,s._)("button",{type:"button",class:"btn button-lightcolor mt-2",onClick:e[2]||(e[2]=(0,r.iM)((e=>t.$router.push("/products")),["prevent"]))},"馬上逛逛")]))])])],64)}var D=a(9939),O=a(5830),Z={data(){return{pageName:"cart",isLoading:!1,CartList:[],cartqty:0,cartLength:0}},components:{OrderNav:D.Z},inject:["emitter"],methods:{toOrder(){this.$router.push("/order")},refreshCart(t,e){const a=`https://vue3-course-api.hexschool.io/api/flower-api/cart/${t.id}`,s={product_id:t.product_id,qty:e};this.$http.put(a,{data:s}).then((t=>{t.data.success&&this.getCarts()})).catch((t=>{this.emitter.emit("push-message",{style:"danger",title:t.response.data})}))},deleteCart(t){const e=`https://vue3-course-api.hexschool.io/api/flower-api/cart/${t}`;this.$http.delete(e).then((t=>{t.data.success&&(this.getCarts(),this.emitter.emit("push-message",{style:"danger",title:t.data.message}))})).catch((t=>{this.emitter.emit("push-message",{style:"danger",title:t.response.data})}))},deleteAllCart(){const t="https://vue3-course-api.hexschool.io/api/flower-api/carts";this.$http.delete(t).then((t=>{t.data.success&&(this.getCarts(),this.emitter.emit("push-message",{style:"danger",title:t.data.message}))})).catch((t=>{this.emitter.emit("push-message",{style:"danger",title:t.response.data})}))}},mixins:[O.Z],created(){this.getCarts()},mounted(){this.emitter.emit("page-change",{data:"cart"})}},z=a(3744);const M=(0,z.Z)(Z,[["render",P]]);var j=M}}]);
//# sourceMappingURL=205.cb590c34.js.map