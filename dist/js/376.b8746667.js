"use strict";(self["webpackChunkinfinity_flowers"]=self["webpackChunkinfinity_flowers"]||[]).push([[376],{5830:function(t,e){e["Z"]={inject:["emitter"],methods:{getCarts(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/flower-api/cart";this.$http.get(t).then((t=>{t.data.success&&(this.cartqty=0,this.isLoading=!1,this.CartList=t.data.data,this.cartLength=t.data.data.carts.length,t.data.data.carts.forEach((t=>{this.cartqty+=t.qty})),this.emitter.emit("push-CartNotice",{data:this.cartLength,category:"cart"}))}))}}}},2497:function(t,e){e["Z"]={methods:{getFavorite(){if(localStorage.getItem("favoriteItem")){const t=localStorage.getItem("favoriteItem");this.idList=JSON.parse(t),this.favoriteLength=this.idList.length}else this.idList=[],this.favoriteLength=0;this.emitter.emit("push-FavNotice",{data:this.favoriteLength,category:"cart"})}}}},685:function(t,e,i){i(7658);e["Z"]={inject:["emitter"],methods:{goForDetail(t){if(localStorage.getItem("viewedItem")){const t=localStorage.getItem("viewedItem");this.viewedList=JSON.parse(t)}else this.viewedList=[];this.viewedList.every((e=>e!==t.id))&&(this.viewedList.push(t.id),localStorage.setItem("viewedItem",JSON.stringify(this.viewedList))),this.emitter.emit("push-ProductDetail",{data:t,qty:1}),this.$router.push(`/products/${t.id}`)}}}},2256:function(t,e,i){i.d(e,{Z:function(){return m}});var a=i(6252),s=i(3577),r=i(9963);const o={"aria-label":"Page navigation example"},c={class:"pagination justify-content-center"},l={class:"page-item"},n=["onClick"],d={class:"page-item"};function g(t,e,i,g,p,h){return(0,a.wg)(),(0,a.iD)("nav",o,[(0,a._)("ul",c,[(0,a._)("li",l,[(0,a._)("a",{class:(0,s.C_)(["page-link page-deep",{disabled:!p.tempPage.has_pre}]),href:"#",tabindex:"-1","aria-disabled":"true",onClick:e[0]||(e[0]=(0,r.iM)((t=>h.updatePage(p.tempPage.current_page-1)),["prevent"]))},"上一頁",2)]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(p.tempPage.total_pages,(t=>((0,a.wg)(),(0,a.iD)("li",{class:"page-item",key:"page"+t},[(0,a._)("a",{class:(0,s.C_)(["page-link page-deep",{active:t===p.tempPage.current_page}]),href:"#",onClick:(0,r.iM)((e=>h.updatePage(t)),["prevent"])},(0,s.zw)(t),11,n)])))),128)),(0,a._)("li",d,[(0,a._)("a",{class:(0,s.C_)(["page-link page-deep",{disabled:!p.tempPage.has_next}]),href:"#",onClick:e[1]||(e[1]=(0,r.iM)((t=>h.updatePage(p.tempPage.current_page+1)),["prevent"]))},"下一頁",2)])])])}var p={data(){return{tempPage:{}}},props:["pages"],watch:{pages(){this.tempPage=this.pages}},methods:{updatePage(t){this.$emit("emit-page",t)}}},h=i(3744);const u=(0,h.Z)(p,[["render",g]]);var m=u},1376:function(t,e,i){i.r(e),i.d(e,{default:function(){return Y}});var a=i(6252),s=i(3577),r=i(9963);const o={class:"container"},c={class:"row"},l={class:"side-bar col-lg-2"},n={class:"nav d-flex flex-lg-column flex-row"},d={class:"nav-item"},g=["onClick"],p={class:"col-lg-10 row ms-0"},h={class:"card mt-1 mb-2 mx-auto product-card"},u=["onClick"],m={class:"overflow-hidden text-light position-relative border-bottom product-card-pic"},v={class:"position-absolute bg-secondary px-2 bottom-0 end-0 rounded m-1"},f={class:"card-text"},y=["src","alt"],_={class:"card-body text-dark"},w={class:"row overflow-hidden"},L=["title"],k={class:"mw-25 text-end col-2 add-favorite"},C=["onClick"],b={key:0,class:"bi bi-heart text-danger",title:"加入收藏"},x={key:1,class:"bi bi-heart-fill text-danger",title:"移除收藏"},P={class:"card-text"},I={key:0,class:"text-decoration-line-through fs-6"},S={class:"fs-5"},D={class:"card-footer"},$=["onClick"],Z={key:0,class:"spinner-border spinner-border-sm text-light",role:"status"},N=(0,a._)("span",{class:"visually-hidden"},"Loading...",-1),O=[N],F={key:1,class:"bi bi-cart-plus"};function M(t,e,i,N,M,z){const q=(0,a.up)("LoadingOverlay"),E=(0,a.up)("Pagination");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(q,{active:M.isLoading},null,8,["active"]),(0,a._)("div",o,[(0,a._)("div",c,[(0,a._)("div",l,[(0,a._)("ul",n,[(0,a._)("li",d,[(0,a._)("a",{class:(0,s.C_)(["nav-link rounded-pill product-category",""===M.category?"text-pastel":"text-deep"]),href:"#","aria-current":"page",onClick:e[0]||(e[0]=(0,r.iM)((t=>M.category=""),["prevent"]))},[(0,a._)("i",{class:(0,s.C_)(["bi bi-flower3 text-pastel",""===M.category?"category-visible":"category-hide"])},null,2),(0,a.Uk)(" 全部商品 ")],2)]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(M.productCategory,((t,e)=>((0,a.wg)(),(0,a.iD)("li",{class:"nav-item",key:"category"+e},[(0,a._)("a",{class:(0,s.C_)(["nav-link text-deep rounded-pill product-category",M.category===t?"text-pastel":"text-deep"]),href:"#",onClick:(0,r.iM)((e=>M.category=t),["prevent"])},[(0,a._)("i",{class:(0,s.C_)(["bi bi-flower3 text-pastel",M.category===t?"category-visible":"category-hide"])},null,2),(0,a.Uk)(" "+(0,s.zw)(t),1)],10,g)])))),128))])]),(0,a._)("div",p,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(z.filterProduct[M.pagination.current_page-1],(e=>((0,a.wg)(),(0,a.iD)("div",{class:"col-sm-12 col-md-6 col-lg-4",key:e.id},[(0,a._)("div",h,[(0,a._)("a",{class:"product-card-item",href:"#",onClick:(0,r.iM)((i=>t.goForDetail(e)),["prevent"])},[(0,a._)("div",m,[(0,a._)("div",v,[(0,a._)("p",f,(0,s.zw)(e.category),1)]),(0,a._)("img",{src:e.imageUrl,alt:e.title,class:"card-img-top d-block align-middle w-100 h-100 w-auto mx-auto"},null,8,y)]),(0,a._)("div",_,[(0,a._)("div",null,[(0,a._)("h5",w,[(0,a._)("div",{class:"card-title col-10 overflow-hidden product-card-title",title:e.title},(0,s.zw)(e.title),9,L),(0,a._)("div",k,[(0,a._)("a",{href:"#",onClick:(0,r.iM)((t=>z.updateFavorite(e)),["stop","prevent"])},[M.idList.every((t=>e.id!==t))?((0,a.wg)(),(0,a.iD)("i",b)):((0,a.wg)(),(0,a.iD)("i",x)),(0,a.Uk)((0,s.zw)(null))],8,C)])])]),(0,a._)("p",P,[e.origin_price!==e.price?((0,a.wg)(),(0,a.iD)("span",I," NT$"+(0,s.zw)(t.$filters.currency(e.origin_price)),1)):(0,a.kq)("",!0),(0,a._)("span",S," NT$"+(0,s.zw)(t.$filters.currency(e.price)),1)])])],8,u),(0,a._)("div",D,[(0,a._)("button",{class:"btn button-light-color w-100",type:"button",onClick:(0,r.iM)((t=>z.addCart(e)),["prevent"])},[M.loadingStatus&&e.id===M.tempCartId?((0,a.wg)(),(0,a.iD)("div",Z,O)):((0,a.wg)(),(0,a.iD)("i",F)),(0,a.Uk)("加入購物車 ")],8,$)])])])))),128))])])]),(0,a.Wm)(E,{pages:M.pagination,onEmitPage:z.getProducts,class:"my-5"},null,8,["pages","onEmitPage"])],64)}i(7658);var z=i(2256),q=i(5830),E=i(2497),J=i(685),U={data(){return{idList:[],tempCartId:"",productList:[],allProductList:[],pagination:{},page:1,productCategory:[],category:"",isLoading:!1,loadingStatus:!1}},components:{Pagination:z.Z},inject:["emitter"],methods:{getProducts(t=1){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/api/flower-api/products?page=${t}`;this.$http.get(e).then((t=>{t.data.success&&(this.productList=t.data.products,this.pagination=t.data.pagination,this.isLoading=!1)})).catch((t=>{this.isLoading=!1,this.emitter.emit("push-message",{style:"danger",title:`${t.response.data.message}`})}))},getCategory(){const t="https://vue3-course-api.hexschool.io/api/flower-api/products/all";this.$http.get(t).then((t=>{if(t.data.success){this.allProductList=t.data.products;const e=[];this.allProductList.forEach((t=>{e.push(t.category)})),this.productCategory=e.filter(((t,e,i)=>i.indexOf(t)===e))}})).catch((t=>{this.emitter.emit("push-message",{style:"danger",title:`${t.response.data.message}`})}))},addCart(t){this.loadingStatus=!0,this.tempCartId=t.id;const e="https://vue3-course-api.hexschool.io/api/flower-api/cart",i={product_id:t.id,qty:1};this.$http.post(e,{data:i}).then((t=>{t.data.success&&(this.emitter.emit("push-message",{style:"success",title:t.data.message}),this.getProducts(),this.getCarts(),this.loadingStatus=!1)})).catch((t=>{this.loadingStatus=!1,this.emitter.emit("push-message",{style:"danger",title:`${t.response.data.message}`})}))},updateFavorite(t){this.idList.every((e=>t.id!==e))?(this.idList.push(t.id),localStorage.setItem("favoriteItem",JSON.stringify(this.idList)),this.emitter.emit("push-message",{style:"success",title:"已新增至收藏"})):(this.idList.indexOf(t.id),this.idList.splice(this.idList.indexOf(t.id),1),localStorage.setItem("favoriteItem",JSON.stringify(this.idList)),this.emitter.emit("push-message",{style:"danger",title:"已取消收藏"})),this.getFavorite()}},computed:{filterProduct(){const t=this.allProductList.filter((t=>t.category.match(this.category))),e=[];return this.pagination.total_pages=t.length%10===0?parseInt(t.length/10,10):parseInt(t.length/10,10)+1,this.pagination.current_page>this.pagination.total_pages&&(this.pagination.current_page=1),t.forEach(((t,i)=>{i%9===0&&e.push([]);const a=parseInt(i/9,9);e[a].push(t)})),e}},mixins:[q.Z,E.Z,J.Z],created(){this.getProducts(),this.getFavorite(),this.getCategory()},mounted(){this.emitter.emit("page-change",{data:"products"})}},j=i(3744);const H=(0,j.Z)(U,[["render",M]]);var Y=H}}]);
//# sourceMappingURL=376.b8746667.js.map