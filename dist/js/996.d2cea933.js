"use strict";(self["webpackChunkinfinity_flowers"]=self["webpackChunkinfinity_flowers"]||[]).push([[996],{5830:function(t,e){e["Z"]={inject:["emitter"],methods:{getCarts(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/flower-api/cart";this.$http.get(t).then((t=>{t.data.success&&(this.cartqty=0,this.isLoading=!1,this.CartList=t.data.data,this.cartLength=t.data.data.carts.length,t.data.data.carts.forEach((t=>{this.cartqty+=t.qty})),this.emitter.emit("push-CartNotice",{data:this.cartLength,category:"cart"}))}))}}}},2771:function(t,e){e["Z"]={methods:{showModal(){this.modal.show()},hideModal(){this.modal.hide()}}}},1381:function(t,e,a){a.d(e,{Z:function(){return w}});var s=a(6252),l=a(3577);const i={class:"mt-2"},o={class:"nav justify-content-center"},r={class:"nav-item"},n={class:"nav-link orderNav text-dark"},c=(0,s._)("span",null,"購物車",-1),d={class:"nav-item"},u={class:"nav-link orderNav text-dark"},h=(0,s._)("span",null,"建立訂單",-1),p={class:"nav-item"},m={class:"nav-link orderNav text-dark"},b=(0,s._)("span",null,"訂單確認",-1),v={class:"nav-item"},g={class:"nav-link orderNav text-dark"},_=(0,s._)("span",null,"訂單完成",-1);function C(t,e,a,C,f,y){return(0,s.wg)(),(0,s.iD)("div",i,[(0,s._)("ul",o,[(0,s._)("li",r,[(0,s._)("p",n,[(0,s._)("i",{class:(0,l.C_)(["bi bi-flower3","cart"===a.PageName?"orderNav-icon":"text-secondary"])},null,2),c])]),(0,s._)("li",d,[(0,s._)("p",u,[(0,s._)("i",{class:(0,l.C_)(["bi bi-flower3","order"===a.PageName?"orderNav-icon":"text-secondary"])},null,2),h])]),(0,s._)("li",p,[(0,s._)("p",m,[(0,s._)("i",{class:(0,l.C_)(["bi bi-flower3","orderChecked"===a.PageName?"orderNav-icon":"text-secondary"])},null,2),b])]),(0,s._)("li",v,[(0,s._)("p",g,[(0,s._)("i",{class:(0,l.C_)(["bi bi-flower3","orderCompleted"===a.PageName?"orderNav-icon":"text-secondary"])},null,2),_])])])])}var f={data(){return{isPage:""}},props:["PageName"]},y=a(3744);const k=(0,y.Z)(f,[["render",C]]);var w=k},4996:function(t,e,a){a.r(e),a.d(e,{default:function(){return A}});a(7658);var s=a(6252),l=a(9963),i=a(3577);const o={class:"container"},r=(0,s._)("h3",{class:"orderNavDetail"},[(0,s._)("i",{class:"bi bi-flower3 text-light-color"}),(0,s._)("span",{class:"text-deep-color"},"購物車")],-1),n={key:0},c=(0,s._)("i",{class:"bi bi-trash3"},null,-1),d={class:"row"},u={class:"card col-md-8 col-lg-7 cart-card mb-md-5"},h={class:"mb-0 row"},p=["onClick"],m=(0,s._)("i",{class:"bi bi-x-lg"},null,-1),b=[m],v=["src","alt"],g={class:"col-7 align-items-center p-0"},_={class:"w-100 fs-5"},C={class:"cartItem-name"},f={class:"input-group"},y=["onClick","disabled"],k=["onUpdate:modelValue","onChange"],w=["onClick"],x={class:"cart-info col-md-4 col-lg-5 col-12 mb-sm-5"},N={class:"ps-md-5 mt-4"},M=(0,s._)("hr",null,null,-1),L={key:1,class:"position-relative text-center my-5 py-5"},D=(0,s._)("h2",null,"購物車沒有東西",-1);function $(t,e,a,m,$,q){const Z=(0,s.up)("LoadingOverlay"),P=(0,s.up)("OrderNav"),z=(0,s.up)("FrontDoubleCheckModal");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(Z,{active:$.isLoading},null,8,["active"]),(0,s._)("div",o,[(0,s.Wm)(P,{PageName:$.pageName,class:"orderNav"},null,8,["PageName"]),r,(0,s._)("div",null,[0!==$.cartLength?((0,s.wg)(),(0,s.iD)("div",n,[(0,s._)("button",{onClick:e[0]||(e[0]=t=>q.openCheckModal("all")),class:"mb-1 btn btn-outline-danger",type:"button"},[c,(0,s.Uk)("全部刪除 ")]),(0,s._)("div",d,[(0,s._)("div",u,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)($.CartList.carts,(t=>((0,s.wg)(),(0,s.iD)("div",{class:"card-body justify-content-around d-flex align-items-center",key:t.id},[(0,s._)("div",h,[(0,s._)("button",{type:"button",onClick:(0,l.iM)((e=>q.openCheckModal(t.id)),["prevent"]),class:"col-1 btn btn-light border-0 text-danger text-center p-0"},b,8,p),(0,s._)("img",{src:t.product.imageUrl,alt:t.product.title,class:"col-4 flex-grow-1"},null,8,v),(0,s._)("div",g,[(0,s._)("div",_,[(0,s._)("p",C,(0,i.zw)(t.product.title),1),(0,s._)("p",null,"NT$"+(0,i.zw)(t.product.price),1),(0,s._)("div",f,[(0,s._)("button",{class:"btn btn-outline-secondary",type:"button",onClick:(0,l.iM)((e=>q.refreshCart(t,t.qty-1)),["prevent"]),disabled:1===t.qty},"-",8,y),(0,s.wy)((0,s._)("input",{type:"number",class:"form-control qty-input",placeholder:"請輸入數量","aria-label":"qty","onUpdate:modelValue":e=>t.qty=e,onChange:(0,l.iM)((e=>q.refreshCart(t,t.qty)),["prevent"])},null,40,k),[[l.nr,t.qty]]),(0,s._)("button",{class:"btn btn-outline-secondary",type:"button",onClick:(0,l.iM)((e=>q.refreshCart(t,t.qty+1)),["prevent"])},"+",8,w)])])])])])))),128))]),(0,s._)("div",x,[(0,s._)("div",N,[(0,s._)("h4",null,"品項 "+(0,i.zw)($.cartLength)+" 個",1),(0,s._)("h4",null,"數量 "+(0,i.zw)($.cartQty)+" 個",1),M,(0,s._)("h3",null,"總價 NT$"+(0,i.zw)($.CartList.total),1),(0,s._)("button",{type:"submit",class:"btn w-100 mt-2 button-light-color btn-lg",onClick:e[1]||(e[1]=(...t)=>q.toOrder&&q.toOrder(...t))},"確認購買")])])])])):((0,s.wg)(),(0,s.iD)("div",L,[D,(0,s._)("button",{type:"button",class:"btn button-light-color mt-2",onClick:e[2]||(e[2]=(0,l.iM)((e=>t.$router.push("/products")),["prevent"]))},"馬上逛逛")]))])]),(0,s.Wm)(z,{ref:"doubleCheckModal",onCartDeleteConfirmed:q.deleteCart},null,8,["onCartDeleteConfirmed"])],64)}var q=a(1381);const Z={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},P={class:"modal-dialog"},z={class:"modal-content"},O=(0,s.uE)('<div class="modal-header"><h5 class="modal-title" id="exampleModalLabel"></h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body text-center"><div class="p-2 doubleCheck-icon"><i class="bi bi-flower3 icon-size"></i></div> 確認移除商品嗎？<br><span class="fw-lighter">(刪除後將無法恢復)</span></div>',2),j={class:"modal-footer mx-auto"};function I(t,e,a,i,o,r){return(0,s.wg)(),(0,s.iD)("div",Z,[(0,s._)("div",P,[(0,s._)("div",z,[O,(0,s._)("div",j,[(0,s._)("button",{type:"button",class:"btn button-deep-color",onClick:e[0]||(e[0]=(0,l.iM)((e=>t.hideModal()),["prevent"]))},"取消"),(0,s._)("button",{type:"button",class:"btn button-light-color",onClick:e[1]||(e[1]=(0,l.iM)((t=>r.deleteConfirmed()),["prevent"]))},"刪除")])])])],512)}var U=a(7424),W=a.n(U),E=a(2771),F={data(){return{modal:{}}},methods:{deleteConfirmed(){this.$emit("cartDelete-confirmed")}},inject:["emitter"],mixins:[E.Z],mounted(){this.modal=new(W())(this.$refs.modal)}},H=a(3744);const Q=(0,H.Z)(F,[["render",I]]);var T=Q,V=a(5830),Y={data(){return{pageName:"cart",isLoading:!1,deleteCartId:"",CartList:[],cartQty:0,cartLength:0}},components:{OrderNav:q.Z,FrontDoubleCheckModal:T},inject:["emitter"],methods:{toOrder(){this.$router.push("/order")},refreshCart(t,e){const a=`https://vue3-course-api.hexschool.io/api/flower-api/cart/${t.id}`,s={product_id:t.product_id,qty:e};this.$http.put(a,{data:s}).then((t=>{t.data.success&&this.getCarts()})).catch((t=>{this.emitter.emit("push-message",{style:"danger",title:t.response.data})}))},openCheckModal(t){this.deleteCartId=t,this.$refs.doubleCheckModal.showModal()},deleteCart(){this.isLoading=!0;let t=`https://vue3-course-api.hexschool.io/api/flower-api/cart/${this.deleteCartId}`;"all"===this.deleteCartId&&(t="https://vue3-course-api.hexschool.io/api/flower-api/carts"),this.$http.delete(t).then((t=>{t.data.success&&(this.isLoading=!1,this.getCarts(),this.emitter.emit("push-message",{style:"danger",title:t.data.message}))})).catch((t=>{this.isLoading=!1,this.emitter.emit("push-message",{style:"danger",title:t.response.data})})),this.$refs.doubleCheckModal.hideModal()}},mixins:[V.Z],created(){this.getCarts()},mounted(){this.emitter.emit("page-change",{data:"cart"})}};const K=(0,H.Z)(Y,[["render",$]]);var A=K}}]);
//# sourceMappingURL=996.d2cea933.js.map