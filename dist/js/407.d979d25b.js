"use strict";(self["webpackChunkinfinity_flowers"]=self["webpackChunkinfinity_flowers"]||[]).push([[407],{5830:function(t,e){e["Z"]={inject:["emitter"],methods:{getCarts(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/flower-api/cart";this.$http.get(t).then((t=>{t.data.success&&(this.cartqty=0,this.isLoading=!1,this.CartList=t.data.data,this.cartLength=t.data.data.carts.length,t.data.data.carts.forEach((t=>{this.cartqty+=t.qty})),this.emitter.emit("push-notice",{data:this.cartLength,category:"cart"}))}))}}}},2497:function(t,e){e["Z"]={methods:{getFavorite(){if(localStorage.getItem("favoriteItem")){const t=localStorage.getItem("favoriteItem");this.idList=JSON.parse(t)}else this.idList=[]}}}},6066:function(t,e,i){i.d(e,{Z:function(){return m}});var a=i(6252),s=i(3577),r=i(9963);const o={"aria-label":"Page navigation example"},l={class:"pagination justify-content-center"},n={class:"page-item"},c=["onClick"],d={class:"page-item"};function p(t,e,i,p,g,h){return(0,a.wg)(),(0,a.iD)("nav",o,[(0,a._)("ul",l,[(0,a._)("li",n,[(0,a._)("a",{class:(0,s.C_)(["page-link",{disabled:!g.temppage.has_pre}]),href:"#",tabindex:"-1","aria-disabled":"true",onClick:e[0]||(e[0]=(0,r.iM)((t=>h.updatePage(g.temppage.current_page-1)),["prevent"]))},"上一頁",2)]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(g.temppage.total_pages,((t,e)=>((0,a.wg)(),(0,a.iD)("li",{class:"page-item",key:e},[(0,a._)("a",{class:(0,s.C_)(["page-link",{active:t===g.temppage.current_page}]),href:"#",onClick:(0,r.iM)((e=>h.updatePage(t)),["prevent"])},(0,s.zw)(t),11,c)])))),128)),(0,a._)("li",d,[(0,a._)("a",{class:(0,s.C_)(["page-link",{disabled:!g.temppage.has_next}]),href:"#",onClick:e[1]||(e[1]=(0,r.iM)((t=>h.updatePage(g.temppage.current_page+1)),["prevent"]))},"下一頁",2)])])])}var g={data(){return{temppage:{}}},props:["pages"],watch:{pages(){this.temppage=this.pages}},methods:{updatePage(t){this.$emit("emit-page",t)}}},h=i(3744);const u=(0,h.Z)(g,[["render",p]]);var m=u},407:function(t,e,i){i.r(e),i.d(e,{default:function(){return Y}});var a=i(6252),s=i(9963),r=i(3577);const o={class:"container"},l={class:"row"},n={class:"side-bar col-lg-2"},c={class:"nav d-flex flex-lg-column flex-row"},d={class:"nav-item"},p=["onClick"],g={class:"col-lg-10 row ms-0"},h={class:"card mt-1 mb-2 mx-auto",style:{"max-width":"280px"}},u=["onClick"],m={class:"overflow-hidden text-light position-relative border-bottom",style:{height:"345px"}},v={class:"position-absolute bg-secondary px-2 bottom-0 end-0 rounded"},f={class:"card-text"},y=["src"],_={class:"card-body text-dark"},w={class:"row overflow-hidden"},k=["title"],x={class:"mw-25 text-end col-2"},b=["onClick"],C={key:0,class:"bi bi-heart text-danger",title:"加入收藏"},L={key:1,class:"bi bi-heart-fill text-danger",title:"移除收藏"},P={class:"card-text"},D={key:0,class:"text-decoration-line-through fs-6"},I={class:"fs-5"},$={class:"card-footer"},S=["onClick"],z={key:0,class:"spinner-border spinner-border-sm text-light",role:"status"},M=(0,a._)("span",{class:"visually-hidden"},"Loading...",-1),Z=[M],F={key:1,class:"bi bi-cart-plus"};function O(t,e,i,M,O,j){const q=(0,a.up)("LoadingOverlay"),E=(0,a.up)("Pagination");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(q,{active:O.isLoading},null,8,["active"]),(0,a._)("div",o,[(0,a._)("div",l,[(0,a._)("div",n,[(0,a._)("ul",c,[(0,a._)("li",d,[(0,a._)("a",{class:"nav-link text-secondary rounded-pill",href:"#","aria-current":"page",onClick:e[0]||(e[0]=(0,s.iM)((t=>O.category=""),["prevent"]))},[(0,a._)("i",{class:"bi bi-flower3 text-danger",style:(0,r.j5)({visibility:""===O.category?"visible":"hidden"})},null,4),(0,a.Uk)(" 全部商品 ")])]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(O.productCategory,((t,e)=>((0,a.wg)(),(0,a.iD)("li",{class:"nav-item",key:e},[(0,a._)("a",{class:"nav-link text-secondary rounded-pill",href:"#",onClick:(0,s.iM)((e=>O.category=t),["prevent"])},[(0,a._)("i",{class:"bi bi-flower3 text-danger",style:(0,r.j5)({visibility:O.category===t?"visible":"hidden"})},null,4),(0,a.Uk)(" "+(0,r.zw)(t),1)],8,p)])))),128))])]),(0,a._)("div",g,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(j.filterProduct[O.pagination.current_page-1],((e,i)=>((0,a.wg)(),(0,a.iD)("div",{class:"col-sm-12 col-md-6 col-lg-4",key:i},[(0,a._)("div",h,[(0,a._)("a",{class:"productcard",href:"#",onClick:(0,s.iM)((t=>j.goForDetail(e.id)),["prevent"])},[(0,a._)("div",m,[(0,a._)("div",v,[(0,a._)("p",f,(0,r.zw)(e.category),1)]),(0,a._)("img",{src:e.imageUrl,alt:"",class:"card-img-top d-block align-middle w-100 h-100 w-auto mx-auto"},null,8,y)]),(0,a._)("div",_,[(0,a._)("div",null,[(0,a._)("h5",w,[(0,a._)("div",{class:"card-title col-10 overflow-hidden",style:{"max-width":"225px","text-overflow":"ellipsis","white-space":"nowrap"},title:e.title},(0,r.zw)(e.title),9,k),(0,a._)("div",x,[(0,a._)("a",{href:"#",onClick:(0,s.iM)((t=>j.updateFavorite(e)),["stop","prevent"])},[O.idList.every((t=>e.id!==t))?((0,a.wg)(),(0,a.iD)("i",C)):((0,a.wg)(),(0,a.iD)("i",L)),(0,a.Uk)((0,r.zw)(null))],8,b)])])]),(0,a._)("p",P,[e.origin_price!==e.price?((0,a.wg)(),(0,a.iD)("span",D," NT$"+(0,r.zw)(t.$filters.currency(e.origin_price)),1)):(0,a.kq)("",!0),(0,a._)("span",I," NT$"+(0,r.zw)(t.$filters.currency(e.price)),1)])])],8,u),(0,a._)("div",$,[(0,a._)("a",{href:"#",class:"btn btn-danger w-100",onClick:(0,s.iM)((t=>j.addCart(e)),["prevent"]),style:{"z-index":"5"}},[O.loadingStatus&&e.id===O.tempCartId?((0,a.wg)(),(0,a.iD)("div",z,Z)):((0,a.wg)(),(0,a.iD)("i",F)),(0,a.Uk)("加入購物車 ")],8,S)])])])))),128))])])]),(0,a.Wm)(E,{pages:O.pagination,onEmitPage:j.getProducts,class:"mt-2"},null,8,["pages","onEmitPage"])],64)}i(7658);var j=i(6066),q=i(5830),E=i(2497),N={data(){return{idList:[],tempCartId:"",productList:[],allProductList:[],pagination:{},page:1,productCategory:[],category:"",isLoading:!1,loadingStatus:!1}},components:{Pagination:j.Z},inject:["emitter"],methods:{getProducts(t=1){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/api/flower-api/products?page=${t}`;this.$http.get(e).then((t=>{t.data.success&&(this.productList=t.data.products,this.pagination=t.data.pagination,this.isLoading=!1)}))},getCategory(){const t="https://vue3-course-api.hexschool.io/api/flower-api/products/all";this.$http.get(t).then((t=>{if(t.data.success){this.allProductList=t.data.products;const e=[];this.allProductList.forEach((t=>{e.push(t.category)})),this.productCategory=e.filter(((t,e,i)=>i.indexOf(t)===e))}}))},addCart(t){this.loadingStatus=!0,this.tempCartId=t.id;const e="https://vue3-course-api.hexschool.io/api/flower-api/cart",i={product_id:t.id,qty:1};this.$http.post(e,{data:i}).then((t=>{t.data.success&&(this.emitter.emit("push-message",{style:"success",title:t.data.message}),this.getProducts(),this.getCarts(),this.loadingStatus=!1)}))},updateFavorite(t){this.idList.every((e=>t.id!==e))?(this.idList.push(t.id),localStorage.setItem("favoriteItem",JSON.stringify(this.idList)),this.emitter.emit("push-message",{style:"success",title:"已新增至收藏"})):(this.idList.indexOf(t.id),this.idList.splice(this.idList.indexOf(t.id),1),localStorage.setItem("favoriteItem",JSON.stringify(this.idList)),this.emitter.emit("push-message",{style:"danger",title:"已取消收藏"})),this.getFavorite()},goForDetail(t){this.$router.push(`/products/${t}`)}},computed:{filterProduct(){const t=this.allProductList.filter((t=>t.category.match(this.category))),e=[];return this.pagination.total_pages=t.length%10===0?parseInt(t.length/10,10):parseInt(t.length/10,10)+1,this.pagination.current_page>this.pagination.total_pages&&(this.pagination.current_page=1),t.forEach(((t,i)=>{i%9===0&&e.push([]);const a=parseInt(i/9,9);e[a].push(t)})),e}},mixins:[q.Z,E.Z],created(){this.getProducts(),this.getFavorite(),this.getCategory()},mounted(){this.emitter.emit("page-change",{data:"products"})}},U=i(3744);const H=(0,U.Z)(N,[["render",O]]);var Y=H}}]);
//# sourceMappingURL=407.d979d25b.js.map